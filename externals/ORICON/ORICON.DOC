	☆☆☆ FMR50 コンソ−ルエミュレ−タ ORICON v1.09 ☆☆☆

●はじめに

  このプログラムはTOWNS-OS上でFMR50のコンソ−ル環境をエミュレ−トしMS-DOS
  プログラムを起動する為の物です
  さらに(山)ちゃん作のOAK2/FEPを内蔵しているのでOAK2を利用した漢字変換も
  通常のキ−入力で行うことが可能です

●使い方

  ORICONのパラメ−タに起動したいプログラム名を指定します
  この時プログラム名はフルパスネ−ムで指定してください
  拡張子やディレクトリ名を省略出来ません

  例えばRED.EXEが"D:\BIN\"デレクトリ上にありT-MENUのアイコンに登録するなら
  ORICON.EXEのパラメ−タに

  D:\BIN\RED.EXE -T4 SAMPLE.TXT

  と指定してください
  以降このアイコンをクリックするだけでT-MENU上から即REDが起動出来ます

  パラメ−タを省略時した場合は"C:\COMMAND.COM"を起動します

●使用上の注意点

  下記のような操作を行っているプログラムをORICON上から起動しないでください

     1. キ−BIOSを酷使したプログラム(スキャンモ−ドにしたり裏ファンクション
	を使用した物)
     2. コンソ−ルBIOSの裏ファンクションを使用した物
     3. グラフィックVRAMにアクセスする物
     4. 直接漢字ROM,ANK CG I/Oをアクセスする物
     5. VSYNC割り込みを使用した物

●v1.01の変更点

  タイマ割り込みをVSYNC割り込みに変更しました
  これでRS232Cでとりこぼしが少なくなるはずです ただしアプリケ−ションで
  当然このVSYNC割り込みを使った場合は，画面更新が行われなくなる可能性が
  ありますので注意してください

●v1.02の変更点

  OAK2/FEPのバ−ジョンアップによる変更を行いました
  ESC[n;....np の文字割り当てシ−ケンスに対応しました

●v1.03の変更点

  OAK2/FEPのバ−ジョンアップによる変更を行いました (OAK2FEP v1.04)
  ESC[6nのカ−ソル位置読み取りシ−ケンスに対応しました
  ESC[0Jのバグを修正しました

●v1.04の変更点

   OAK2/FEPのささいなバグを修正(enc_cnt & kancnvflg)した

●v1.05の変更点

   PAROU氏により文字表示が高速オプティマイズされた

   ANKフォントの変更か容易に出来るようにコンソ−ルBIOSを拡張した

	AH = 21h
	DL = 先頭のキャラクタ−コ−ド
	CX = 変更したいフォントのサイズ(バイト数)
	DS:DI = 変更するフォントデ−タのアドレス

   この拡張BIOSを使用したサンプルプログラム"ORIANK"を付属する

	ORIANK CENTURY.FOT

●v1.06の変更点

   C-LIBの関数であるfreopen()をBIOS.ASMで独自に作成しライブラリの
   LINK時におきる無駄を無くした

   MS-C v6 のタイニ−モデルに変更し強引にメモリを削減した

   注意点としてMS-C v6.00 のバグ?によりVDB.Cをアセンブルの形にして
   修正を行ってからリンクしている・・・・なんとも・・・・

   あと強引にメモリを開放する為にBIOS.ASM内のFORK関数で細工している

●v1.07の変更点

   Cのスタ−トアップを無くす為にプログラムのエントリを独自に作成した
   これで普通のCOMモデルになった（ただしVDB.Cの問題はv1.06と同じである！）

   MS-DOSファンクションのint 21h 0Ahである文字列入力において簡単な行編集
   が出来るようにHistoryを内蔵してみた

   ←,→,BS,削除	行編集
   ↑,↓		ヒストリの呼び出し
   前行,次行,^E,^R	検索しながらのヒストリの呼び出し
   PF3,^A		前入力文字列の再編集
   HOME,^D		ツイン入力バッファの切り換え
   ^X,^U		編集文字列削除

   あまり頻度が無いのようなのでv1.05で対応したANKフォントの変更機能を
   削除した｡ (フォントバッファが4Kあるのでもったいない！)

●v1.08の変更点

   MS-C v6.00の/ATコンパイルに問題があった
   DS,ESセグメントを他の値で使用した場合にデ−タ参照にSSを使用するような
   コ−ドが排出されているが今回のような割り込み処理には適しないコ−ドである
   コンパイルオプションで"/Asnw"としてみた

   多少のANSIエスケ−プシ−ケンスを追加した

   History機能のキ−を多少変更し使用頻度の高い?↑↓キ−で検索とした

   一部のイニシャルル−チンを子プロセス起動時には開放するように配置した

●v1.09の変更点

   History機能にファイル名補完を追加した  したがってこのバ−ジョンでの
   キ−アサインなどを記載する

   ←,→,BS,削除	行編集
   ↑,↓		検索しながらのヒストリの呼び出し
   前行,次行,^E,^R	ヒストリの呼び出し
   PF3,^A		前入力文字列の再編集
   HOME,^D		ツイン入力バッファの切り換え
   ^X			編集文字列削除
   ^U			ファイル名補完を実行

   ◇↑,↓キ−による検索しながらのヒストリの呼び出しの使い方

	red test.c
	cl /Ox /c test.c
	link test,test;
	exe2bin test.exe test.com
	del test.exe

	と入力した後で再度"red test.c"を実行するなら

	red↑

	とするだけで

	red test.c

	と前歴より検索する

   ◇^Uキ−によるファイル名補完の使い方 

	"compress.exe"を実行したい場合は

	comp^U

	compress

	とすると環境変数"PATH"にしたがって"COMPRESS.[COM/EXE/BAT]"を検索する

	但し編集行の先頭以外でファイル名補完を行った場合は環境変数"PATH"を
	参照せずに現在のカレントディレクトリのみサ−チする

	cl *.c^U

	cl test.c

	さらに編集行の先頭であっても検索するファイル名にディレクトリやドライブ
	名を含めた場合などはその指定した範囲しか検索しない

●対応したコンロ−ルBIOS一覧

-------------:----------------------------------------:----------
   機能コ−ド:           説            明
-------------:----------------------------------------:----------
	00	初期化	
	01	画面の表示制御				未対応
	02	全画面消去
	03	表示画面サイズの設定			未対応
	04	表示画面サイズの読み取り
	05	表示画面サイズレパ−トリの読み取り 	80x25のみ
	06	アトリビュート機能範囲の読み取り
	07	フォントパタ−ンの取り出し
	08	外字パタ−ンの登録			未対応
	09	カ−ソル形状の設定
	0A	カ−ソル形状の読み取り
	0B	カ−ソル表示状態の設定
	0C	カ−ソル表示状態の読み取り
	0D	カーソル位置の指定
	0E	カーソル位置の読み取り
	0F	アトリビュートの設定
	10	アトリビュートの読み取り
	11	デフォルトアトリビュ−トの設定
	12	デフォルトアトリビュ−トの読み取り
	13	文字設定
	14	文字読み取り
	15	矩形域設定
	16	矩形域読み取り
	17	矩形域複写
	18	矩形域消去
	19	全画面スクロ−ル
	1A	部分スクロ−ル
	1B	コンソ−ル機能の設定
	1C	コンソ−ル機能の読み取り
	1D	文字の出力
	1E	文字列の出力
	1F	システム行書き込み
	20	背景色の読み取り			未対応
	21	ANKフォントの変更			ORICONオリジナル
-------------:----------------------------------------:----------

●プログラムの配布に関して

  このプログムはいかなる制限も付けません. 

  自由に転送,配布してくださっても結構です. 
  出来るだけソ−スコ−ドも一緒に配布することを望みます

  ソ−スコ−ドの変更/更新/参照も自由に行っていただいて結構です
  もし機能拡張さられたならPDSとして多くの方に配布されることを望みます

  ただしこのプログラムによる損害が発生しても一切責任を負いません

●最後に

  このプログラム作成にあたり多大なる協力をしてくださった(山)ちゃん，
  さらにORICONと命名してくださったNifty-Serveの杉本ひろおさん，
  に深く感謝いたします


						ｂｙ　ＭＩＹＡＺＡＫＩ
