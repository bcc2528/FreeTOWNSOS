#include "EGB.H"
#include "TGBIOS.H"
#include <DOS.H>


struct EGB_ScreenMode EGB_SCREENMODES[19]=
{
	{ // Zero is not used
		0,
		{0,0}, //struct POINTW visiSize;
		{0,0}, //struct POINTW size;
		0,//unsigned short bytesPerLine;
		0,//unsigned short bytesPerLineShift;  // 0:Can not shift  Non-Zero:Can shift (bytesPerLine is 2^n)
		0,//unsigned char bitsPerPixel;
		{EGB_INVALID_SCRNMODE,EGB_INVALID_SCRNMODE,EGB_INVALID_SCRNMODE,EGB_INVALID_SCRNMODE},//unsigned char combination[4];

		0,//unsigned int flags;
		{0,0},//struct POINTW defZoom;

		NULL,//_Far unsigned char *vram;
	},
	{ // Mode 1
		24, // KHz
		{640,400}, //struct POINTW visiSize;
		{640,819}, //struct POINTW size;
		320,//unsigned short bytesPerLine;
		0,//unsigned short bytesPerLineShift;  // 0:Can not shift  Non-Zero:Can shift (bytesPerLine is 2^n)
		4,//unsigned char bitsPerPixel;
		{1,EGB_INVALID_SCRNMODE,EGB_INVALID_SCRNMODE,EGB_INVALID_SCRNMODE},//unsigned char combination[4];

		0,//unsigned int flags;
		{1,1},//struct POINTW defZoom;

		NULL,//_Far unsigned char *vram;
	},
	{ // Mode 2
		24, // KHz
		{640,200}, //struct POINTW visiSize;
		{640,819}, //struct POINTW size;
		320,//unsigned short bytesPerLine;
		0,//unsigned short bytesPerLineShift;  // 0:Can not shift  Non-Zero:Can shift (bytesPerLine is 2^n)
		4,//unsigned char bitsPerPixel;
		{2,EGB_INVALID_SCRNMODE,EGB_INVALID_SCRNMODE,EGB_INVALID_SCRNMODE},//unsigned char combination[4];

		0,//unsigned int flags;
		{1,2},//struct POINTW defZoom;

		NULL,//_Far unsigned char *vram;
	},
	{ // Mode 3
		31, // KHz
		{640,480}, //struct POINTW visiSize;
		{1024,512}, //struct POINTW size;
		512,//unsigned short bytesPerLine;
		9,//unsigned short bytesPerLineShift;  // 0:Can not shift  Non-Zero:Can shift (bytesPerLine is 2^n)
		4,//unsigned char bitsPerPixel;
		{3,5,10,EGB_INVALID_SCRNMODE},//unsigned char combination[4];

		SCRNMODE_FLAG_HSCROLL|SCRNMODE_FLAG_VSCROLL,//unsigned int flags;
		{1,1},//struct POINTW defZoom;

		NULL,//_Far unsigned char *vram;
	},
	{ // Mode 4
		31, // KHz
		{640,400}, //struct POINTW visiSize;
		{1024,512}, //struct POINTW size;
		512,//unsigned short bytesPerLine;
		9,//unsigned short bytesPerLineShift;  // 0:Can not shift  Non-Zero:Can shift (bytesPerLine is 2^n)
		4,//unsigned char bitsPerPixel;
		{4,6,EGB_INVALID_SCRNMODE,EGB_INVALID_SCRNMODE},//unsigned char combination[4];

		SCRNMODE_FLAG_HSCROLL|SCRNMODE_FLAG_VSCROLL,//unsigned int flags;
		{1,1},//struct POINTW defZoom;

		NULL,//_Far unsigned char *vram;
	},
	{ // Mode 5
		31, // KHz
		{256,256}, //struct POINTW visiSize;
		{256,512}, //struct POINTW size;
		512,//unsigned short bytesPerLine;
		9,//unsigned short bytesPerLineShift;  // 0:Can not shift  Non-Zero:Can shift (bytesPerLine is 2^n)
		16,//unsigned char bitsPerPixel;
		{5,3,10,EGB_INVALID_SCRNMODE},//unsigned char combination[4];

		SCRNMODE_FLAG_STARTPOS|SCRNMODE_FLAG_HSCROLL|SCRNMODE_FLAG_VSCROLL,//unsigned int flags;
		{1,1},//struct POINTW defZoom;

		NULL,//_Far unsigned char *vram;
	},
	{ // Mode 6
		31, // KHz
		{256,256}, //struct POINTW visiSize;
		{256,512}, //struct POINTW size;
		512,//unsigned short bytesPerLine;
		9,//unsigned short bytesPerLineShift;  // 0:Can not shift  Non-Zero:Can shift (bytesPerLine is 2^n)
		16,//unsigned char bitsPerPixel;
		{4,6,EGB_INVALID_SCRNMODE,EGB_INVALID_SCRNMODE},//unsigned char combination[4];

		SCRNMODE_FLAG_STARTPOS|SCRNMODE_FLAG_HSCROLL|SCRNMODE_FLAG_VSCROLL,//unsigned int flags;
		{1,1},//struct POINTW defZoom;

		NULL,//_Far unsigned char *vram;
	},
	{ // Mode 7
		15, // KHz
		{256,240}, //struct POINTW visiSize;
		{256,512}, //struct POINTW size;
		512,//unsigned short bytesPerLine;
		9,//unsigned short bytesPerLineShift;  // 0:Can not shift  Non-Zero:Can shift (bytesPerLine is 2^n)
		16,//unsigned char bitsPerPixel;
		{7,9,EGB_INVALID_SCRNMODE,EGB_INVALID_SCRNMODE},//unsigned char combination[4];

		SCRNMODE_FLAG_STARTPOS|SCRNMODE_FLAG_HSCROLL|SCRNMODE_FLAG_VSCROLL,//unsigned int flags;
		{4,1},//struct POINTW defZoom;

		NULL,//_Far unsigned char *vram;
	},
	{ // Mode 8
		15, // KHz
		{256,240}, //struct POINTW visiSize;
		{256,512}, //struct POINTW size;
		512,//unsigned short bytesPerLine;
		9,//unsigned short bytesPerLineShift;  // 0:Can not shift  Non-Zero:Can shift (bytesPerLine is 2^n)
		16,//unsigned char bitsPerPixel;
		{8,11,EGB_INVALID_SCRNMODE,EGB_INVALID_SCRNMODE},//unsigned char combination[4];

		SCRNMODE_FLAG_STARTPOS|SCRNMODE_FLAG_HSCROLL|SCRNMODE_FLAG_VSCROLL,//unsigned int flags;
		{4,1},//struct POINTW defZoom;

		NULL,//_Far unsigned char *vram;
	},
	{ // Mode 9
		15, // KHz
		{360,240}, //struct POINTW visiSize;
		{512,256}, //struct POINTW size;
		1024,//unsigned short bytesPerLine;
		10,//unsigned short bytesPerLineShift;  // 0:Can not shift  Non-Zero:Can shift (bytesPerLine is 2^n)
		16,//unsigned char bitsPerPixel;
		{7,9,EGB_INVALID_SCRNMODE,EGB_INVALID_SCRNMODE},//unsigned char combination[4];

		SCRNMODE_FLAG_VSCROLL|SCRNMODE_FLAG_HSCROLL,//unsigned int flags;
		{4,1},//struct POINTW defZoom;

		NULL,//_Far unsigned char *vram;
	},
	{ // Mode 10
		31, // KHz
		{320,240}, //struct POINTW visiSize;
		{512,256}, //struct POINTW size;
		1024,//unsigned short bytesPerLine;
		10,//unsigned short bytesPerLineShift;  // 0:Can not shift  Non-Zero:Can shift (bytesPerLine is 2^n)
		16,//unsigned char bitsPerPixel;
		{3,5,10,EGB_INVALID_SCRNMODE},//unsigned char combination[4];

		SCRNMODE_FLAG_STARTPOS|SCRNMODE_FLAG_VSCROLL|SCRNMODE_FLAG_HSCROLL,//unsigned int flags;
		{1,1},//struct POINTW defZoom;

		NULL,//_Far unsigned char *vram;
	},
	{ // Mode 11
		15, // KHz
		{320,240}, //struct POINTW visiSize;
		{512,256}, //struct POINTW size;
		1024,//unsigned short bytesPerLine;
		10,//unsigned short bytesPerLineShift;  // 0:Can not shift  Non-Zero:Can shift (bytesPerLine is 2^n)
		16,//unsigned char bitsPerPixel;
		{8,11,EGB_INVALID_SCRNMODE,EGB_INVALID_SCRNMODE},//unsigned char combination[4];

		SCRNMODE_FLAG_VSCROLL|SCRNMODE_FLAG_HSCROLL,//unsigned int flags;
		{4,1},//struct POINTW defZoom;

		NULL,//_Far unsigned char *vram;
	},
	{ // Mode 12
		31, // KHz
		{640,480}, //struct POINTW visiSize;
		{1024,512}, //struct POINTW size;
		1024,//unsigned short bytesPerLine;
		10,//unsigned short bytesPerLineShift;  // 0:Can not shift  Non-Zero:Can shift (bytesPerLine is 2^n)
		8,//unsigned char bitsPerPixel;
		{EGB_INVALID_SCRNMODE,EGB_INVALID_SCRNMODE,EGB_INVALID_SCRNMODE,EGB_INVALID_SCRNMODE},//unsigned char combination[4];

		SCRNMODE_FLAG_VSCROLL|SCRNMODE_FLAG_HSCROLL,//unsigned int flags;
		{1,1},//struct POINTW defZoom;

		NULL,//_Far unsigned char *vram;
	},
	{ // Mode 13
		31, // KHz
		{640,400}, //struct POINTW visiSize;
		{1024,512}, //struct POINTW size;
		1024,//unsigned short bytesPerLine;
		10,//unsigned short bytesPerLineShift;  // 0:Can not shift  Non-Zero:Can shift (bytesPerLine is 2^n)
		8,//unsigned char bitsPerPixel;
		{EGB_INVALID_SCRNMODE,EGB_INVALID_SCRNMODE,EGB_INVALID_SCRNMODE,EGB_INVALID_SCRNMODE},//unsigned char combination[4];

		SCRNMODE_FLAG_VSCROLL|SCRNMODE_FLAG_HSCROLL,//unsigned int flags;
		{1,1},//struct POINTW defZoom;

		NULL,//_Far unsigned char *vram;
	},
	{ // Mode 14
		15, // KHz
		{720,480}, //struct POINTW visiSize;
		{1024,512}, //struct POINTW size;
		1024,//unsigned short bytesPerLine;
		10,//unsigned short bytesPerLineShift;  // 0:Can not shift  Non-Zero:Can shift (bytesPerLine is 2^n)
		8,//unsigned char bitsPerPixel;
		{EGB_INVALID_SCRNMODE,EGB_INVALID_SCRNMODE,EGB_INVALID_SCRNMODE,EGB_INVALID_SCRNMODE},//unsigned char combination[4];

		SCRNMODE_FLAG_VSCROLL|SCRNMODE_FLAG_HSCROLL,//unsigned int flags;
		{2,1},//struct POINTW defZoom;

		NULL,//_Far unsigned char *vram;
	},
	{ // Mode 15
		31, // KHz
		{320,480}, //struct POINTW visiSize;
		{512,512}, //struct POINTW size;
		1024,//unsigned short bytesPerLine;
		10,//unsigned short bytesPerLineShift;  // 0:Can not shift  Non-Zero:Can shift (bytesPerLine is 2^n)
		16,//unsigned char bitsPerPixel;
		{EGB_INVALID_SCRNMODE,EGB_INVALID_SCRNMODE,EGB_INVALID_SCRNMODE,EGB_INVALID_SCRNMODE},//unsigned char combination[4];

		SCRNMODE_FLAG_VSCROLL|SCRNMODE_FLAG_HSCROLL,//unsigned int flags;
		{2,1},//struct POINTW defZoom;

		NULL,//_Far unsigned char *vram;
	},
	{ // Mode 16
		15, // KHz
		{320,480}, //struct POINTW visiSize;
		{512,512}, //struct POINTW size;
		1024,//unsigned short bytesPerLine;
		10,//unsigned short bytesPerLineShift;  // 0:Can not shift  Non-Zero:Can shift (bytesPerLine is 2^n)
		16,//unsigned char bitsPerPixel;
		{EGB_INVALID_SCRNMODE,EGB_INVALID_SCRNMODE,EGB_INVALID_SCRNMODE,EGB_INVALID_SCRNMODE},//unsigned char combination[4];

		SCRNMODE_FLAG_VSCROLL|SCRNMODE_FLAG_HSCROLL,//unsigned int flags;
		{4,1},//struct POINTW defZoom;

		NULL,//_Far unsigned char *vram;
	},
	{ // Mode 17
		31, // KHz
		{512,480}, //struct POINTW visiSize;
		{512,512}, //struct POINTW size;
		1024,//unsigned short bytesPerLine;
		10,//unsigned short bytesPerLineShift;  // 0:Can not shift  Non-Zero:Can shift (bytesPerLine is 2^n)
		16,//unsigned char bitsPerPixel;
		{EGB_INVALID_SCRNMODE,EGB_INVALID_SCRNMODE,EGB_INVALID_SCRNMODE,EGB_INVALID_SCRNMODE},//unsigned char combination[4];

		SCRNMODE_FLAG_HSCROLL|SCRNMODE_FLAG_VSCROLL,//unsigned int flags;
		{1,1},//struct POINTW defZoom;

		NULL,//_Far unsigned char *vram;
	},
	{ // Mode 18
		15, // KHz
		{512,480}, //struct POINTW visiSize;
		{512,512}, //struct POINTW size;
		1024,//unsigned short bytesPerLine;
		10,//unsigned short bytesPerLineShift;  // 0:Can not shift  Non-Zero:Can shift (bytesPerLine is 2^n)
		16,//unsigned char bitsPerPixel;
		{EGB_INVALID_SCRNMODE,EGB_INVALID_SCRNMODE,EGB_INVALID_SCRNMODE,EGB_INVALID_SCRNMODE},//unsigned char combination[4];

		SCRNMODE_FLAG_HSCROLL|SCRNMODE_FLAG_VSCROLL,//unsigned int flags;
		{2,1},//struct POINTW defZoom;

		NULL,//_Far unsigned char *vram;
	}
};

_Far struct EGB_ScreenMode *EGB_GetScreenModeProp(int mode)
{
	if(mode<19)
	{
		_Far struct EGB_ScreenMode *ptr;
		_FP_SEG(ptr)=SEG_TGBIOS_CODE; // Read-access from CS is good enough.
		_FP_OFF(ptr)=(unsigned int)&EGB_SCREENMODES[mode];
		return ptr;
	}
	return NULL;
}

unsigned short EGB_CRTCREGS[EGB_NUM_MODECOMB][38]=
{
	{
	0x0C,0xFF,
//   HSW1  HSW2   ----   ----   HST    VST1   VST2   EET    VST    HDS0   HDE0   HDS1   HDE1   VDS0   VDE1   VDS1
	0x0060,0x02C0,0x0000,0x0000,0x031F,0x0000,0x0004,0x0000,0x0419,0x008A,0x030A,0x008A,0x030A,0x0046,0x0406,0x0046,
	0x0406,0x0000,0x008A,0x0000,0x0080,0x0000,0x008A,0x0000,0x0080,0x0058,0x0001,0x0000,0x800F,0x0002,0x0000,0x0192,
//   VDE1  FA0    HAJ0   FO0    LO0    FA1    HAJ1   FO1    LO1    EHAJ   EVAJ   ZOOM   CR0    CR1    FR     CR2
	0x0A,0x18,0x00,0x00,
	},
	{
	0x0D,0xFF,
//   HSW1  HSW2   ----   ----   HST    VST1   VST2   EET    VST    HDS0   HDE0   HDS1   HDE1   VDS0   VDE1   VDS1
	0x0040,0x0320,0x0000,0x0000,0x035F,0x0000,0x0010,0x0000,0x036F,0x009C,0x031C,0x009C,0x031C,0x0040,0x0360,0x0040,
	0x0360,0x0000,0x009C,0x0000,0x0080,0x0000,0x009C,0x0000,0x0080,0x004A,0x0001,0x0000,0x800F,0x0003,0x0000,0x0150,
//   VDE1  FA0    HAJ0   FO0    LO0    FA1    HAJ1   FO1    LO1    EHAJ   EVAJ   ZOOM   CR0    CR1    FR     CR2
	0x0A,0x18,0x00,0x00,
	},
	{
	0x0E,0xFF,
//   HSW1  HSW2   ----   ----   HST    VST1   VST2   EET    VST    HDS0   HDE0   HDS1   HDE1   VDS0   VDE1   VDS1
	0x0086,0x0610,0x0000,0x0000,0x071B,0x0006,0x000C,0x0012,0x020C,0x0129,0x06C9,0x0129,0x06C9,0x002A,0x020A,0x002A,
	0x020A,0x0000,0x0129,0x0080,0x0100,0x0000,0x0129,0x0080,0x0100,0x0064,0x0001,0x0101,0x800F,0x000C,0x0003,0x01CA,
//   VDE1  FA0    HAJ0   FO0    LO0    FA1    HAJ1   FO1    LO1    EHAJ   EVAJ   ZOOM   CR0    CR1    FR     CR2
	0x0A,0x18,0x00,0x00,
	},
	{
	0x0F,0xFF,
//   HSW1  HSW2   ----   ----   HST    VST1   VST2   EET    VST    HDS0   HDE0   HDS1   HDE1   VDS0   VDE1   VDS1
	0x0060,0x02C0,0x0000,0x0000,0x031F,0x0000,0x0004,0x0000,0x0419,0x008A,0x030A,0x008A,0x030A,0x0046,0x0406,0x0046,
	0x0406,0x0000,0x008A,0x0000,0x0080,0x0000,0x008A,0x0000,0x0080,0x0058,0x0001,0x0101,0x800A,0x0002,0x0000,0x0192,
//   VDE1  FA0    HAJ0   FO0    LO0    FA1    HAJ1   FO1    LO1    EHAJ   EVAJ   ZOOM   CR0    CR1    FR     CR2
	0x0F,0x08,0x00,0x00,
	},
	{
	0x10,0xFF,
//   HSW1  HSW2   ----   ----   HST    VST1   VST2   EET    VST    HDS0   HDE0   HDS1   HDE1   VDS0   VDE1   VDS1
	0x0074,0x0530,0x0000,0x0000,0x0617,0x0006,0x000C,0x0012,0x020C,0x00E7,0x05E7,0x00E7,0x05E7,0x002A,0x020A,0x002A,
	0x020A,0x0000,0x00E7,0x0080,0x0100,0x0000,0x00E7,0x0080,0x0100,0x0056,0x0001,0x0303,0x800A,0x0001,0x0002,0x0188,
//   VDE1  FA0    HAJ0   FO0    LO0    FA1    HAJ1   FO1    LO1    EHAJ   EVAJ   ZOOM   CR0    CR1    FR     CR2
	0x0F,0x08,0x00,0x00,
	},
	{
	0x01,0x01,
//   HSW1  HSW2   ----   ----   HST    VST1   VST2   EET    VST    HDS0   HDE0   HDS1   HDE1   VDS0   VDE1   VDS1
	0x0040,0x0320,0x0000,0x0000,0x035F,0x0000,0x0010,0x0000,0x036F,0x009C,0x031C,0x009C,0x031C,0x0040,0x0360,0x0040,
	0x0360,0x0000,0x009C,0x0000,0x0050,0x0000,0x009C,0x0000,0x0050,0x004A,0x0001,0x0000,0x803F,0x0003,0x0000,0x0150,
//   VDE1  FA0    HAJ0   FO0    LO0    FA1    HAJ1   FO1    LO1    EHAJ   EVAJ   ZOOM   CR0    CR1    FR     CR2
	0x15,0x28,0x00,0x00,
	},
	{
	0xFF,0xFF,
//   HSW1  HSW2   ----   ----   HST    VST1   VST2   EET    VST    HDS0   HDE0   HDS1   HDE1   VDS0   VDE1   VDS1
	0x0040,0x0320,0x0000,0x0000,0x035F,0x0000,0x0010,0x0000,0x036F,0x009C,0x031C,0x009C,0x031C,0x0040,0x0360,0x0040,
	0x0360,0x0000,0x009C,0x0000,0x0050,0x0000,0x009C,0x0000,0x0050,0x004A,0x0001,0x0000,0x803F,0x0003,0x0000,0x0150,
//   VDE1  FA0    HAJ0   FO0    LO0    FA1    HAJ1   FO1    LO1    EHAJ   EVAJ   ZOOM   CR0    CR1    FR     CR2
	0x15,0x28,0x00,0x00,
	},
	{
	0x02,0x02,
//   HSW1  HSW2   ----   ----   HST    VST1   VST2   EET    VST    HDS0   HDE0   HDS1   HDE1   VDS0   VDE1   VDS1
	0x0040,0x0320,0x0000,0x0000,0x035F,0x0000,0x0010,0x0000,0x036F,0x009C,0x031C,0x009C,0x031C,0x0040,0x0360,0x0040,
	0x0360,0x0000,0x009C,0x0000,0x0050,0x0000,0x009C,0x0000,0x0050,0x004A,0x0001,0x1010,0x803F,0x0003,0x0000,0x0150,
//   VDE1  FA0    HAJ0   FO0    LO0    FA1    HAJ1   FO1    LO1    EHAJ   EVAJ   ZOOM   CR0    CR1    FR     CR2
	0x15,0x28,0x00,0x00,
	},
	{
	0x03,0x03,
//   HSW1  HSW2   ----   ----   HST    VST1   VST2   EET    VST    HDS0   HDE0   HDS1   HDE1   VDS0   VDE1   VDS1
	0x0060,0x02C0,0x0000,0x0000,0x031F,0x0000,0x0004,0x0000,0x0419,0x008A,0x030A,0x008A,0x030A,0x0046,0x0406,0x0046,
	0x0406,0x0000,0x008A,0x0000,0x0080,0x0000,0x008A,0x0000,0x0080,0x0058,0x0001,0x0000,0x800F,0x0002,0x0000,0x0192,
//   VDE1  FA0    HAJ0   FO0    LO0    FA1    HAJ1   FO1    LO1    EHAJ   EVAJ   ZOOM   CR0    CR1    FR     CR2
	0x15,0x28,0x00,0x00,
	},
	{
	0x04,0x04,
//   HSW1  HSW2   ----   ----   HST    VST1   VST2   EET    VST    HDS0   HDE0   HDS1   HDE1   VDS0   VDE1   VDS1
	0x0040,0x0320,0x0000,0x0000,0x035F,0x0000,0x0010,0x0000,0x036F,0x009C,0x031C,0x009C,0x031C,0x0040,0x0360,0x0040,
	0x0360,0x0000,0x009C,0x0000,0x0080,0x0000,0x009C,0x0000,0x0080,0x004A,0x0001,0x0000,0x800F,0x0003,0x0000,0x0150,
//   VDE1  FA0    HAJ0   FO0    LO0    FA1    HAJ1   FO1    LO1    EHAJ   EVAJ   ZOOM   CR0    CR1    FR     CR2
	0x15,0x28,0x00,0x00,
	},
	{
	0x06,0x04,
//   HSW1  HSW2   ----   ----   HST    VST1   VST2   EET    VST    HDS0   HDE0   HDS1   HDE1   VDS0   VDE1   VDS1
	0x0040,0x0320,0x0000,0x0000,0x035F,0x0000,0x0010,0x0000,0x036F,0x009C,0x019C,0x009C,0x031C,0x0040,0x0240,0x0040,
	0x0360,0x0000,0x009C,0x0000,0x0080,0x0000,0x009C,0x0000,0x0080,0x004A,0x0001,0x0000,0x800D,0x0003,0x0000,0x0150,
//   VDE1  FA0    HAJ0   FO0    LO0    FA1    HAJ1   FO1    LO1    EHAJ   EVAJ   ZOOM   CR0    CR1    FR     CR2
	0x17,0x28,0x00,0x00,
	},
	{
	0x09,0x09,
//   HSW1  HSW2   ----   ----   HST    VST1   VST2   EET    VST    HDS0   HDE0   HDS1   HDE1   VDS0   VDE1   VDS1
	0x0086,0x0610,0x0000,0x0000,0x071B,0x0006,0x000C,0x0012,0x020C,0x0129,0x06C9,0x0129,0x06C9,0x002A,0x020A,0x002A,
	0x020A,0x0000,0x0129,0x0000,0x0100,0x0000,0x0129,0x0000,0x0100,0x0064,0x0001,0x0303,0x8005,0x000C,0x0003,0x01CA,
//   VDE1  FA0    HAJ0   FO0    LO0    FA1    HAJ1   FO1    LO1    EHAJ   EVAJ   ZOOM   CR0    CR1    FR     CR2
	0x1F,0x28,0x00,0x00,
	},
	{
	0x07,0x09,
//   HSW1  HSW2   ----   ----   HST    VST1   VST2   EET    VST    HDS0   HDE0   HDS1   HDE1   VDS0   VDE1   VDS1
	0x0086,0x0610,0x0000,0x0000,0x071B,0x0006,0x000C,0x0012,0x020C,0x0129,0x0529,0x0129,0x06C9,0x002A,0x020A,0x002A,
	0x020A,0x0000,0x0129,0x0000,0x0080,0x0000,0x0129,0x0000,0x0100,0x0064,0x0001,0x0303,0x8005,0x000C,0x0003,0x01CA,
//   VDE1  FA0    HAJ0   FO0    LO0    FA1    HAJ1   FO1    LO1    EHAJ   EVAJ   ZOOM   CR0    CR1    FR     CR2
	0x1F,0x28,0x00,0x00,
	},
	{
	0x0B,0x0B,
//   HSW1  HSW2   ----   ----   HST    VST1   VST2   EET    VST    HDS0   HDE0   HDS1   HDE1   VDS0   VDE1   VDS1
	0x0074,0x0530,0x0000,0x0000,0x0617,0x0006,0x000C,0x0012,0x020B,0x00E7,0x05E7,0x00E7,0x05E7,0x002A,0x020A,0x002A,
	0x020A,0x0000,0x00E7,0x0000,0x0100,0x0000,0x00E7,0x0000,0x0100,0x0056,0x0001,0x0303,0x8005,0x0001,0x0002,0x0188,
//   VDE1  FA0    HAJ0   FO0    LO0    FA1    HAJ1   FO1    LO1    EHAJ   EVAJ   ZOOM   CR0    CR1    FR     CR2
	0x1F,0x28,0x00,0x00,
	},
	{
	0x08,0x0B,
//   HSW1  HSW2   ----   ----   HST    VST1   VST2   EET    VST    HDS0   HDE0   HDS1   HDE1   VDS0   VDE1   VDS1
	0x0074,0x0530,0x0000,0x0000,0x0617,0x0006,0x000C,0x0012,0x020B,0x00E7,0x04E7,0x00E7,0x05E7,0x002A,0x020A,0x002A,
	0x020A,0x0000,0x00E7,0x0000,0x0080,0x0000,0x00E7,0x0000,0x0100,0x0056,0x0001,0x0303,0x8005,0x0001,0x0002,0x0188,
//   VDE1  FA0    HAJ0   FO0    LO0    FA1    HAJ1   FO1    LO1    EHAJ   EVAJ   ZOOM   CR0    CR1    FR     CR2
	0x1F,0x28,0x00,0x00,
	},
	{
	0x06,0x06,
//   HSW1  HSW2   ----   ----   HST    VST1   VST2   EET    VST    HDS0   HDE0   HDS1   HDE1   VDS0   VDE1   VDS1
	0x0040,0x0320,0x0000,0x0000,0x035F,0x0000,0x0010,0x0000,0x036F,0x009C,0x019C,0x009C,0x019C,0x0040,0x0240,0x0040,
	0x0240,0x0000,0x009C,0x0000,0x0080,0x0000,0x009C,0x0000,0x0080,0x004A,0x0001,0x0000,0x8005,0x0003,0x0000,0x0150,
//   VDE1  FA0    HAJ0   FO0    LO0    FA1    HAJ1   FO1    LO1    EHAJ   EVAJ   ZOOM   CR0    CR1    FR     CR2
	0x1F,0x28,0x00,0x00,
	},
	{
	0x07,0x07,
//   HSW1  HSW2   ----   ----   HST    VST1   VST2   EET    VST    HDS0   HDE0   HDS1   HDE1   VDS0   VDE1   VDS1
	0x0086,0x0610,0x0000,0x0000,0x071B,0x0006,0x000C,0x0012,0x020C,0x0129,0x0529,0x0129,0x0529,0x002A,0x020A,0x002A,
	0x020A,0x0000,0x0129,0x0000,0x0080,0x0000,0x0129,0x0000,0x0080,0x0064,0x0001,0x0303,0x8005,0x000C,0x0003,0x01CA,
//   VDE1  FA0    HAJ0   FO0    LO0    FA1    HAJ1   FO1    LO1    EHAJ   EVAJ   ZOOM   CR0    CR1    FR     CR2
	0x1F,0x28,0x00,0x00,
	},
	{
	0x08,0x08,
//   HSW1  HSW2   ----   ----   HST    VST1   VST2   EET    VST    HDS0   HDE0   HDS1   HDE1   VDS0   VDE1   VDS1
	0x0074,0x0530,0x0000,0x0000,0x0617,0x0006,0x000C,0x0012,0x020B,0x00E7,0x04E7,0x00E7,0x04E7,0x002A,0x020A,0x002A,
	0x020A,0x0000,0x00E7,0x0000,0x0080,0x0000,0x00E7,0x0000,0x0080,0x0056,0x0001,0x0303,0x8005,0x0001,0x0002,0x0188,
//   VDE1  FA0    HAJ0   FO0    LO0    FA1    HAJ1   FO1    LO1    EHAJ   EVAJ   ZOOM   CR0    CR1    FR     CR2
	0x1F,0x28,0x00,0x00,
	},
	{
	0x05,0x03,
//   HSW1  HSW2   ----   ----   HST    VST1   VST2   EET    VST    HDS0   HDE0   HDS1   HDE1   VDS0   VDE1   VDS1
	0x0060,0x02C0,0x0000,0x0000,0x031F,0x0000,0x0004,0x0000,0x0419,0x008A,0x018A,0x008A,0x030A,0x0046,0x0246,0x0046,
	0x0406,0x0000,0x008A,0x0000,0x0080,0x0000,0x008A,0x0000,0x0080,0x0058,0x0001,0x0000,0x800D,0x0002,0x0000,0x0192,
//   VDE1  FA0    HAJ0   FO0    LO0    FA1    HAJ1   FO1    LO1    EHAJ   EVAJ   ZOOM   CR0    CR1    FR     CR2
	0x17,0x28,0x00,0x00,
	},
	{
	0x05,0x05,
//   HSW1  HSW2   ----   ----   HST    VST1   VST2   EET    VST    HDS0   HDE0   HDS1   HDE1   VDS0   VDE1   VDS1
	0x0060,0x02C0,0x0000,0x0000,0x031F,0x0000,0x0004,0x0000,0x0419,0x008A,0x018A,0x008A,0x018A,0x0046,0x0246,0x0046,
	0x0246,0x0000,0x008A,0x0000,0x0080,0x0000,0x008A,0x0000,0x0080,0x0058,0x0001,0x0000,0x8005,0x0002,0x0000,0x0192,
//   VDE1  FA0    HAJ0   FO0    LO0    FA1    HAJ1   FO1    LO1    EHAJ   EVAJ   ZOOM   CR0    CR1    FR     CR2
	0x1F,0x28,0x00,0x00,
	},
	{
	0xFF,0xFF,
//   HSW1  HSW2   ----   ----   HST    VST1   VST2   EET    VST    HDS0   HDE0   HDS1   HDE1   VDS0   VDE1   VDS1
	0x0060,0x02C0,0x0000,0x0000,0x031F,0x0000,0x0004,0x0000,0x0419,0x008A,0x018A,0x008A,0x018A,0x0046,0x0246,0x0046,
	0x0246,0x0000,0x008A,0x0000,0x0080,0x0000,0x008A,0x0000,0x0080,0x0058,0x0001,0x0000,0x8005,0x0002,0x0000,0x0192,
//   VDE1  FA0    HAJ0   FO0    LO0    FA1    HAJ1   FO1    LO1    EHAJ   EVAJ   ZOOM   CR0    CR1    FR     CR2
	0x1F,0x28,0x00,0x00,
	},
	{
	0x03,0x05,
//   HSW1  HSW2   ----   ----   HST    VST1   VST2   EET    VST    HDS0   HDE0   HDS1   HDE1   VDS0   VDE1   VDS1
	0x0060,0x02C0,0x0000,0x0000,0x031F,0x0000,0x0004,0x0000,0x0419,0x008A,0x030A,0x008A,0x018A,0x0046,0x0406,0x0046,
	0x0246,0x0000,0x008A,0x0000,0x0080,0x0000,0x008A,0x0000,0x0080,0x0058,0x0001,0x0000,0x8007,0x0002,0x0000,0x0192,
//   VDE1  FA0    HAJ0   FO0    LO0    FA1    HAJ1   FO1    LO1    EHAJ   EVAJ   ZOOM   CR0    CR1    FR     CR2
	0x1D,0x28,0x00,0x00,
	},
	{
	0x04,0x06,
//   HSW1  HSW2   ----   ----   HST    VST1   VST2   EET    VST    HDS0   HDE0   HDS1   HDE1   VDS0   VDE1   VDS1
	0x0040,0x0320,0x0000,0x0000,0x035F,0x0000,0x0010,0x0000,0x036F,0x009C,0x031C,0x009C,0x019C,0x0040,0x0360,0x0040,
	0x0240,0x0000,0x009C,0x0000,0x0080,0x0000,0x009C,0x0000,0x0080,0x004A,0x0001,0x0000,0x8007,0x0003,0x0000,0x0150,
//   VDE1  FA0    HAJ0   FO0    LO0    FA1    HAJ1   FO1    LO1    EHAJ   EVAJ   ZOOM   CR0    CR1    FR     CR2
	0x1D,0x28,0x00,0x00,
	},
	{
	0x09,0x07,
//   HSW1  HSW2   ----   ----   HST    VST1   VST2   EET    VST    HDS0   HDE0   HDS1   HDE1   VDS0   VDE1   VDS1
	0x0086,0x0610,0x0000,0x0000,0x071B,0x0006,0x000C,0x0012,0x020C,0x0129,0x06C9,0x0129,0x0529,0x002A,0x020A,0x002A,
	0x020A,0x0000,0x0129,0x0000,0x0100,0x0000,0x0129,0x0000,0x0080,0x0064,0x0001,0x0303,0x8005,0x000C,0x0003,0x01CA,
//   VDE1  FA0    HAJ0   FO0    LO0    FA1    HAJ1   FO1    LO1    EHAJ   EVAJ   ZOOM   CR0    CR1    FR     CR2
	0x1F,0x28,0x00,0x00,
	},
	{
	0x0B,0x08,
//   HSW1  HSW2   ----   ----   HST    VST1   VST2   EET    VST    HDS0   HDE0   HDS1   HDE1   VDS0   VDE1   VDS1
	0x0074,0x0530,0x0000,0x0000,0x0617,0x0006,0x000C,0x0012,0x020B,0x00E7,0x05E7,0x00E7,0x04E7,0x002A,0x020A,0x002A,
	0x020A,0x0000,0x00E7,0x0000,0x0100,0x0000,0x00E7,0x0000,0x0080,0x0056,0x0001,0x0303,0x8005,0x0001,0x0002,0x0188,
//   VDE1  FA0    HAJ0   FO0    LO0    FA1    HAJ1   FO1    LO1    EHAJ   EVAJ   ZOOM   CR0    CR1    FR     CR2
	0x1F,0x28,0x00,0x00,
	},
	{
	0x03,0x0A,
//   HSW1  HSW2   ----   ----   HST    VST1   VST2   EET    VST    HDS0   HDE0   HDS1   HDE1   VDS0   VDE1   VDS1
	0x0060,0x02C0,0x0000,0x0000,0x031F,0x0000,0x0004,0x0000,0x0419,0x008A,0x030A,0x008A,0x01CA,0x0046,0x0406,0x0046,
	0x0226,0x0000,0x008A,0x0000,0x0080,0x0000,0x008A,0x0000,0x0100,0x0058,0x0001,0x0000,0x8007,0x0002,0x0000,0x0192,
//   VDE1  FA0    HAJ0   FO0    LO0    FA1    HAJ1   FO1    LO1    EHAJ   EVAJ   ZOOM   CR0    CR1    FR     CR2
	0x1D,0x28,0x00,0x00,
	},
	{
	0x0A,0x03,
//   HSW1  HSW2   ----   ----   HST    VST1   VST2   EET    VST    HDS0   HDE0   HDS1   HDE1   VDS0   VDE1   VDS1
	0x0060,0x02C0,0x0000,0x0000,0x031F,0x0000,0x0004,0x0000,0x0419,0x008A,0x01CA,0x008A,0x030A,0x0046,0x0226,0x0046,
	0x0406,0x0000,0x008A,0x0000,0x0100,0x0000,0x008A,0x0000,0x0080,0x0058,0x0001,0x0000,0x800D,0x0002,0x0000,0x0192,
//   VDE1  FA0    HAJ0   FO0    LO0    FA1    HAJ1   FO1    LO1    EHAJ   EVAJ   ZOOM   CR0    CR1    FR     CR2
	0x17,0x28,0x00,0x00,
	},
	{
	0x0A,0x0A,
//   HSW1  HSW2   ----   ----   HST    VST1   VST2   EET    VST    HDS0   HDE0   HDS1   HDE1   VDS0   VDE1   VDS1
	0x0060,0x02C0,0x0000,0x0000,0x031F,0x0000,0x0004,0x0000,0x0419,0x008A,0x01CA,0x008A,0x01CA,0x0046,0x0226,0x0046,
	0x0226,0x0000,0x008A,0x0000,0x0100,0x0000,0x008A,0x0000,0x0100,0x0058,0x0001,0x0000,0x8005,0x0002,0x0000,0x0192,
//   VDE1  FA0    HAJ0   FO0    LO0    FA1    HAJ1   FO1    LO1    EHAJ   EVAJ   ZOOM   CR0    CR1    FR     CR2
	0x1F,0x28,0x00,0x00,
	},
	{
	0x0A,0x05,
//   HSW1  HSW2   ----   ----   HST    VST1   VST2   EET    VST    HDS0   HDE0   HDS1   HDE1   VDS0   VDE1   VDS1
	0x0060,0x02C0,0x0000,0x0000,0x031F,0x0000,0x0004,0x0000,0x0419,0x008A,0x01CA,0x008A,0x018A,0x0046,0x0226,0x0046,
	0x0246,0x0000,0x008A,0x0000,0x0100,0x0000,0x008A,0x0000,0x0080,0x0058,0x0000,0x0000,0x8005,0x0002,0x0000,0x0192,
//   VDE1  FA0    HAJ0   FO0    LO0    FA1    HAJ1   FO1    LO1    EHAJ   EVAJ   ZOOM   CR0    CR1    FR     CR2
	0x1F,0x28,0x00,0x00,
	},
	{
	0x05,0x0A,
//   HSW1  HSW2   ----   ----   HST    VST1   VST2   EET    VST    HDS0   HDE0   HDS1   HDE1   VDS0   VDE1   VDS1
	0x0060,0x02C0,0x0000,0x0000,0x031F,0x0000,0x0004,0x0000,0x0419,0x008A,0x018A,0x008A,0x01CA,0x0046,0x0246,0x0046,
	0x0226,0x0000,0x008A,0x0000,0x0080,0x0000,0x008A,0x0000,0x0100,0x0058,0x0000,0x0000,0x8005,0x0002,0x0000,0x0192,
//   VDE1  FA0    HAJ0   FO0    LO0    FA1    HAJ1   FO1    LO1    EHAJ   EVAJ   ZOOM   CR0    CR1    FR     CR2
	0x1F,0x28,0x00,0x00,
	},
	{
	0x11,0xFF,
//   HSW1  HSW2   ----   ----   HST    VST1   VST2   EET    VST    HDS0   HDE0   HDS1   HDE1   VDS0   VDE1   VDS1
	0x0060,0x02C0,0x0000,0x0000,0x031F,0x0000,0x0004,0x0000,0x0419,0x00CA,0x02CA,0x00CA,0x02CA,0x0046,0x0406,0x0046,
	0x0406,0x0000,0x00CA,0x0000,0x0080,0x0000,0x00CA,0x0000,0x0080,0x0058,0x0001,0x0000,0x800A,0x0002,0x0000,0x0192,
//   VDE1  FA0    HAJ0   FO0    LO0    FA1    HAJ1   FO1    LO1    EHAJ   EVAJ   ZOOM   CR0    CR1    FR     CR2
	0x0F,0x08,0x00,0x00,
	},
	{
	0x12,0xFF,
//   HSW1  HSW2   ----   ----   HST    VST1   VST2   EET    VST    HDS0   HDE0   HDS1   HDE1   VDS0   VDE1   VDS1
	0x0074,0x0530,0x0000,0x0000,0x0617,0x0006,0x000C,0x0012,0x020C,0x0167,0x0567,0x0167,0x0567,0x002A,0x020A,0x002A,
	0x020A,0x0000,0x0167,0x0080,0x0100,0x0000,0x0167,0x0080,0x0100,0x0056,0x0001,0x0101,0x800A,0x0001,0x0002,0x0188,
//   VDE1  FA0    HAJ0   FO0    LO0    FA1    HAJ1   FO1    LO1    EHAJ   EVAJ   ZOOM   CR0    CR1    FR     CR2
	0x0F,0x08,0x00,0x00,
	},
	{
	0x01,0x04,
//   HSW1  HSW2   ----   ----   HST    VST1   VST2   EET    VST    HDS0   HDE0   HDS1   HDE1   VDS0   VDE1   VDS1
	0x0074,0x0530,0x0000,0x0000,0x0617,0x0006,0x000C,0x0012,0x020C,0x0167,0x0567,0x0167,0x0567,0x002A,0x020A,0x002A,
	0x020A,0x0000,0x0167,0x0080,0x0100,0x0000,0x0167,0x0080,0x0100,0x0056,0x0001,0x0101,0x800A,0x0001,0x0002,0x0188,
//   VDE1  FA0    HAJ0   FO0    LO0    FA1    HAJ1   FO1    LO1    EHAJ   EVAJ   ZOOM   CR0    CR1    FR     CR2
	0x0F,0x08,0x00,0x00,
	}
};

_Far unsigned short *EGB_GetCRTCRegs(int modeComb)
{
	if(modeComb<33)
	{
		_Far unsigned short *ptr;
		_FP_SEG(ptr)=SEG_TGBIOS_CODE; // Read-access from CS is good enough.
		_FP_OFF(ptr)=(unsigned int)(EGB_CRTCREGS[modeComb]);
		return ptr;
	}
	else
	{
		return NULL;
	}
}


static unsigned int EGB_defaultPalette256[]=
{
0x000000,0x00007F,0x0000BF,0x0000FF,0x3F0000,0x3F007F,0x3F00BF,0x3F00FF,0x5F0000,0x5F007F,0x5F00BF,0x5F00FF,0x7F0000,0x7F007F,0x7F00BF,0x7F00FF,
0x9F0000,0x9F007F,0x9F00BF,0x9F00FF,0xBF0000,0xBF007F,0xBF00BF,0xBF00FF,0xDF0000,0xDF007F,0xDF00BF,0xDF00FF,0xFF0000,0xFF007F,0xFF00BF,0xFF00FF,
0x003F00,0x003F7F,0x003FBF,0x003FFF,0x3F3F00,0x3F3F7F,0x3F3FBF,0x3F3FFF,0x5F3F00,0x5F3F7F,0x5F3FBF,0x5F3FFF,0x7F3F00,0x7F3F7F,0x7F3FBF,0x7F3FFF,
0x9F3F00,0x9F3F7F,0x9F3FBF,0x9F3FFF,0xBF3F00,0xBF3F7F,0xBF3FBF,0xBF3FFF,0xDF3F00,0xDF3F7F,0xDF3FBF,0xDF3FFF,0xFF3F00,0xFF3F7F,0xFF3FBF,0xFF3FFF,
0x005F00,0x005F7F,0x005FBF,0x005FFF,0x3F5F00,0x3F5F7F,0x3F5FBF,0x3F5FFF,0x5F5F00,0x5F5F7F,0x5F5FBF,0x5F5FFF,0x7F5F00,0x7F5F7F,0x7F5FBF,0x7F5FFF,
0x9F5F00,0x9F5F7F,0x9F5FBF,0x9F5FFF,0xBF5F00,0xBF5F7F,0xBF5FBF,0xBF5FFF,0xDF5F00,0xDF5F7F,0xDF5FBF,0xDF5FFF,0xFF5F00,0xFF5F7F,0xFF5FBF,0xFF5FFF,
0x007F00,0x007F7F,0x007FBF,0x007FFF,0x3F7F00,0x3F7F7F,0x3F7FBF,0x3F7FFF,0x5F7F00,0x5F7F7F,0x5F7FBF,0x5F7FFF,0x7F7F00,0x7F7F7F,0x7F7FBF,0x7F7FFF,
0x9F7F00,0x9F7F7F,0x9F7FBF,0x9F7FFF,0xBF7F00,0xBF7F7F,0xBF7FBF,0xBF7FFF,0xDF7F00,0xDF7F7F,0xDF7FBF,0xDF7FFF,0xFF7F00,0xFF7F7F,0xFF7FBF,0xFF7FFF,
0x009F00,0x009F7F,0x009FBF,0x009FFF,0x3F9F00,0x3F9F7F,0x3F9FBF,0x3F9FFF,0x5F9F00,0x5F9F7F,0x5F9FBF,0x5F9FFF,0x7F9F00,0x7F9F7F,0x7F9FBF,0x7F9FFF,
0x9F9F00,0x9F9F7F,0x9F9FBF,0x9F9FFF,0xBF9F00,0xBF9F7F,0xBF9FBF,0xBF9FFF,0xDF9F00,0xDF9F7F,0xDF9FBF,0xDF9FFF,0xFF9F00,0xFF9F7F,0xFF9FBF,0xFF9FFF,
0x00BF00,0x00BF7F,0x00BFBF,0x00BFFF,0x3FBF00,0x3FBF7F,0x3FBFBF,0x3FBFFF,0x5FBF00,0x5FBF7F,0x5FBFBF,0x5FBFFF,0x7FBF00,0x7FBF7F,0x7FBFBF,0x7FBFFF,
0x9FBF00,0x9FBF7F,0x9FBFBF,0x9FBFFF,0xBFBF00,0xBFBF7F,0xBFBFBF,0xBFBFFF,0xDFBF00,0xDFBF7F,0xDFBFBF,0xDFBFFF,0xFFBF00,0xFFBF7F,0xFFBFBF,0xFFBFFF,
0x00DF00,0x00DF7F,0x00DFBF,0x00DFFF,0x3FDF00,0x3FDF7F,0x3FDFBF,0x3FDFFF,0x5FDF00,0x5FDF7F,0x5FDFBF,0x5FDFFF,0x7FDF00,0x7FDF7F,0x7FDFBF,0x7FDFFF,
0x9FDF00,0x9FDF7F,0x9FDFBF,0x9FDFFF,0xBFDF00,0xBFDF7F,0xBFDFBF,0xBFDFFF,0xDFDF00,0xDFDF7F,0xDFDFBF,0xDFDFFF,0xFFDF00,0xFFDF7F,0xFFDFBF,0xFFDFFF,
0x00FF00,0x00FF7F,0x00FFBF,0x00FFFF,0x3FFF00,0x3FFF7F,0x3FFFBF,0x3FFFFF,0x5FFF00,0x5FFF7F,0x5FFFBF,0x5FFFFF,0x7FFF00,0x7FFF7F,0x7FFFBF,0x7FFFFF,
0x9FFF00,0x9FFF7F,0x9FFFBF,0x9FFFFF,0xBFFF00,0xBFFF7F,0xBFFFBF,0xBFFFFF,0xDFFF00,0xDFFF7F,0xDFFFBF,0xDFFFFF,0xFFFF00,0xFFFF7F,0xFFFFBF,0xFFFFFF,
};

static unsigned int EGB_defaultPalette16[]=
{
0x000000,0x000088,0x880000,0x880088,0x008800,0x008888,0x888800,0x888888,0x444444,0x0000FF,0xFF0000,0xFF00FF,0x00FF00,0x00FFFF,0xFFFF00,0xFFFFFF,
0x000000,0x000088,0x880000,0x880088,0x008800,0x008888,0x888800,0x888888,0x444444,0x0000FF,0xFF0000,0xFF00FF,0x00FF00,0x00FFFF,0xFFFF00,0xFFFFFF,
};

_Far unsigned int *EGB_GetDefaultPalette256(void)
{
	_Far unsigned int *ptr;
	_FP_SEG(ptr)=SEG_TGBIOS_CODE; // Read-access from CS is good enough.
	_FP_OFF(ptr)=(unsigned int)(EGB_defaultPalette256);
	return ptr;
}
_Far unsigned int *EGB_GetDefaultPalette16(void)
{
	_Far unsigned int *ptr;
	_FP_SEG(ptr)=SEG_TGBIOS_CODE; // Read-access from CS is good enough.
	_FP_OFF(ptr)=(unsigned int)(EGB_defaultPalette16);
	return ptr;
}
